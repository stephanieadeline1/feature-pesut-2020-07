{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack:///../src/apmonth.js","webpack:///../src/apdate.js","webpack:///../src/utils.js","webpack:///../src/pluralize.js","webpack:///../src/widont.js","webpack:///./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack:///./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/esm/inherits.js","webpack:///./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack:///./app/scripts/utils/get-current-url.js","webpack:///./app/scripts/components/Ribbon.js","webpack:///./app/scripts/utils/throttle.js","webpack:///./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack:///./app/scripts/utils/feeds.js"],"names":["_classCallCheck","instance","Constructor","TypeError","AP_MONTHS","0","1","2","3","4","5","6","7","8","9","10","11","apmonth","date","Date","getMonth","apdate","getDate","getFullYear","isNil","value","singularSuffix","widontRegex","RegExp","widont","val","replaceChar","String","replace","_assertThisInitialized","self","ReferenceError","_setPrototypeOf","o","p","Object","setPrototypeOf","__proto__","_inherits","subClass","superClass","prototype","create","constructor","writable","configurable","_getPrototypeOf","getPrototypeOf","_possibleConstructorReturn","call","getCurrentUrl","loc","window","location","protocol","host","pathname","Ribbon","state","loadSucceeded","scrollingDown","stories","previousYOffset","onScroll","bind","throttledOnScroll","callback","wait","context","this","timeout","callbackArgs","later","apply","arguments","setTimeout","throttle","pageYOffset","setState","addEventListener","fetch","TRENDING_STORIES_URL","then","res","json","data","results","removeEventListener","_","navClass","currentUrl","filter","story","url","class","href","slice","map","i","storyClass","key","id","ga-event-category","ga-event-action","ga-event-label","headline","Component","_defineProperties","target","props","length","descriptor","enumerable","defineProperty","_createClass","protoProps","staticProps","BUILD_RELATED_CONTENT_URL","gutenTag","numberOfStories"],"mappings":"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","file":"Ribbon.7c76711fa2.js","sourcesContent":["export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","/**\n * Map of AP month abbreviations. Note that they are zero-indexed due to\n * JavaScript's life choices. Exported for testing purposes.\n *\n * @private\n * @type {object}\n */\nexport const AP_MONTHS = {\n  0: 'Jan.',\n  1: 'Feb.',\n  2: 'March',\n  3: 'April',\n  4: 'May',\n  5: 'June',\n  6: 'July',\n  7: 'Aug.',\n  8: 'Sept.',\n  9: 'Oct.',\n  10: 'Nov.',\n  11: 'Dec.',\n};\n\n/**\n * Returns an AP-formatted month string that corresponds with the supplied\n * Date. If an `input` is not passed, it will use the result of `new Date();`.\n *\n * @param  {Date} [date] JavaScript Date object, defaults to current date if\n *                       not passed\n * @return {string}\n * @example\n *\n * var journalize = require('journalize');\n *\n * // Remember that JavaScript zero-indexes months!\n * journalize.apmonth(new Date(2016, 10, 8));\n * // returns 'Nov.'\n *\n * // Uses the current date if no parameter is passed\n * journalize.apmonth();\n * // returns 'July' (pretend it is actually July)\n */\nexport default function apmonth(date = new Date()) {\n  return AP_MONTHS[date.getMonth()];\n}\n","import apmonth from './apmonth';\n\n/**\n * Returns an AP-formatted date string that corresponds with the supplied\n * Date. If an `input` is not passed, it will use the result of `new Date();`.\n *\n * @param  {Date} [date] JavaScript Date object, defaults to current date if\n *                       not passed\n * @return {string}\n * @example\n *\n * var journalize = require('journalize');\n *\n * // Remember that JavaScript zero-indexes months!\n * journalize.apdate(new Date(2016, 10, 8));\n * // returns 'Nov. 8, 2016'\n *\n * // Uses the current date if no parameter is passed\n * journalize.apdate();\n * // returns 'July 4, 2016' (pretend it is actually July 4, 2016)\n */\nexport default function apdate(date = new Date()) {\n  const month = apmonth(date);\n  const dayOfMonth = date.getDate();\n  const year = date.getFullYear();\n\n  return `${month} ${dayOfMonth}, ${year}`;\n}\n","/**\n * Returns true if `value` is null or undefined;\n *\n * @private\n * @param  {*}  value\n * @return {boolean}\n */\nexport function isNil(value) {\n  return value == null;\n}\n\n/**\n * Returns true if `value` is a finite number.\n *\n * Based on: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isFinite\n *\n * @private\n * @param  {*}  value\n * @return {boolean}\n */\nexport function _isFinite(value) {\n  return typeof value === 'number' && isFinite(value);\n}\n\n/**\n * Returns true if `value` is an integer.\n *\n * Based on: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger\n *\n * @private\n * @param  {*}  value\n * @return {boolean}\n */\nexport function isInteger(value) {\n  return _isFinite(value) && Math.floor(value) === value;\n}\n","/**\n * Returns a plural suffix if the value is not 1. By default, `pluralize`\n * uses \"s\" as the suffix. If a `String` is provided, `pluralize` will attempt\n * to convert it into a `Number`. If an `Array` is provided instead of a\n * number, the length of the `Array` is used to determine the suffix. An\n * alternative plural suffix can be provided as the second parameter, and if\n * necessary, an alternative singular suffix can be provided as the third.\n *\n * @param {number|string|array} value\n * @param {string} [pluralSuffix='s']\n * @param {string} [singularSuffix='']\n * @return {string}\n * @example\n *\n * var journalize = require('journalize');\n *\n * // typical usage\n * 'vote' + journalize.pluralize(0); // votes\n * 'vote' + journalize.pluralize(1); // vote\n * 'vote' + journalize.pluralize(2); // votes\n *\n * // the plural suffix may be changed\n * 'class' + journalize.pluralize(0, 'es'); // classes\n * 'class' + journalize.pluralize(1, 'es'); // class\n * 'class' + journalize.pluralize(2, 'es'); // classes\n *\n * // some words also need a custom singular suffix\n * 'cand' + journalize.pluralize(0, 'ies', 'y'); // candies\n * 'cand' + journalize.pluralize(1, 'ies', 'y'); // candy\n * 'cand' + journalize.pluralize(2, 'ies', 'y'); // candies\n */\nexport default function pluralize(\n  value,\n  pluralSuffix = 's',\n  singularSuffix = ''\n) {\n  // if this is an array, base the return value on the length\n  if (Array.isArray(value)) {\n    if (value.length !== 1) {\n      return pluralSuffix;\n    } else {\n      return singularSuffix;\n    }\n  }\n\n  // otherwise we have a string or number - convert it and test if its 1\n  if (Number(value) !== 1) {\n    return pluralSuffix;\n  }\n\n  return singularSuffix;\n}\n","import { isNil } from './utils';\n\n/**\n * The non-breaking space character added to the string passed to widont.\n * Exported for testing purposes.\n *\n * @private\n * @type {string}\n */\nexport const nbsp = '\\xA0';\n\n/**\n * The regular expression to find the final space in a string for widont.\n *\n * @private\n * @type {RegExp}\n */\nconst widontRegex = new RegExp(/\\s+([^\\s]*)\\s*$/);\n\n/**\n * Prevents \"widows\" - a word by itself on a line - from appearing in strings\n * by replacing the space between the last two words with a non-breaking space\n * character.\n *\n * @param {string} val\n * @param {string} [replaceChar='\\xA0'] The character to replace the space with\n * @returns {string}\n * @example\n *\n * var journalize = require('journalize');\n *\n * journalize.widont('this is a string');\n * // returns 'this is a&nbsp;string'\n *\n * journalize.widont('this is a string', 'HELLO');\n * // returns 'this is aHELLOstring'\n *\n */\nexport default function widont(val, replaceChar = nbsp) {\n  // if `val` is undefined or null, return an empty string\n  if (isNil(val)) return '';\n\n  // coerce value to a String\n  const str = String(val);\n\n  return str.replace(widontRegex, `${replaceChar}$1`);\n}\n","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","import _typeof from \"../../helpers/esm/typeof\";\nimport assertThisInitialized from \"./assertThisInitialized\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}","function getCurrentUrl() {\n  const loc = window.location;\n  return `${loc.protocol}//${loc.host}${loc.pathname}`;\n}\n\nexport default getCurrentUrl;\n","import { Component, h } from 'preact';\nimport { widont } from 'journalize';\n\nimport getCurrentUrl from '../utils/get-current-url';\nimport throttle from '../utils/throttle';\nimport { TRENDING_STORIES_URL } from '../utils/feeds';\n\nclass Ribbon extends Component {\n  constructor() {\n    super();\n\n    this.state = {\n      loadSucceeded: false,\n      scrollingDown: false,\n      stories: [],\n    };\n\n    this.previousYOffset = -1;\n    this.onScroll = this.onScroll.bind(this);\n    this.throttledOnScroll = throttle(this.onScroll, 300);\n  }\n\n  onScroll() {\n    const pageYOffset = window.pageYOffset;\n    const previousYOffset = this.previousYOffset;\n\n    let scrollingDown;\n\n    if (pageYOffset > previousYOffset) {\n      scrollingDown = true;\n    } else if (pageYOffset < previousYOffset) {\n      scrollingDown = false;\n    }\n\n    this.previousYOffset = pageYOffset;\n    this.setState({ scrollingDown });\n  }\n\n  componentDidMount() {\n    window.addEventListener('scroll', this.throttledOnScroll, false);\n\n    fetch(TRENDING_STORIES_URL)\n      .then(res => res.json())\n      .then(data => {\n        const stories = data.results ? data.results : data;\n\n        this.setState({ loadSucceeded: true, stories });\n      });\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('scroll', this.throttledOnScroll, false);\n  }\n\n  render(_, { loadSucceeded, scrollingDown, stories }) {\n    let navClass = scrollingDown ? 'ribbon ribbon--inactive' : 'ribbon';\n\n    if (!loadSucceeded) {\n      navClass += ' ribbon--hidden';\n    }\n\n    const currentUrl = getCurrentUrl();\n    stories = stories.filter(story => story.url !== currentUrl);\n\n    return (\n      <nav class={navClass}>\n        <p class=\"ribbon__title\">\n          Trending on{' '}\n          <a href=\"https://www.texastribune.org/\">The Texas Tribune</a>\n        </p>\n        <ul class=\"ribbon__stories\">\n          {stories.slice(0, 4).map((story, i) => {\n            let storyClass = 'ribbon__story';\n\n            if (i === 2) storyClass += ' ribbon__story--three';\n            if (i === 3) storyClass += ' ribbon__story--four';\n\n            return (\n              <li\n                key={story.id}\n                class={storyClass}\n                ga-event-category=\"read more\"\n                ga-event-action=\"trending\"\n                ga-event-label=\"apps page\"\n              >\n                <a href={story.url}>{widont(story.headline)}</a>\n              </li>\n            );\n          })}\n        </ul>\n      </nav>\n    );\n  }\n}\n\nexport default Ribbon;\n","export default function throttle(callback, wait, context = this) {\n  let timeout = null;\n  let callbackArgs = null;\n\n  const later = () => {\n    callback.apply(context, callbackArgs);\n    timeout = null;\n  };\n\n  return function() {\n    if (!timeout) {\n      callbackArgs = arguments;\n      timeout = setTimeout(later, wait);\n    }\n  };\n}\n","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","const TRENDING_STORIES_URL =\n  'https://www.texastribune.org/api/v2/articles/most_viewed/?format=json&limit=5';\nconst BUILD_RELATED_CONTENT_URL = ({ gutenTag, numberOfStories = 4 }) =>\n  `https://www.texastribune.org/api/v2/articles/?content_type=story,audio,video,pointer&tag=${gutenTag}&tag!=object-tribcast&fields=id,url,pub_date,headline,summary,sitewide_image&limit=${numberOfStories}&format=json`;\n\nexport { BUILD_RELATED_CONTENT_URL, TRENDING_STORIES_URL };\n"],"sourceRoot":""}